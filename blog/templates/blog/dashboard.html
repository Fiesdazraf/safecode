{% extends "blog/dashboard_base.html" %}
{% block title %}ูุฏุฑุช ูพุณุชโูุง{% endblock %}

{% block content %}
<!-- ฺฉุงุฑุช ุฎูุดโุขูุฏ ู ูุนุฑู ูพูู -->
<div class="alert alert-info mb-4 shadow-sm">
  <b>ุจู ูพูู ูุฏุฑุช SafeCode CMS ุฎูุด ุขูุฏุฏ!</b>
  <span class="d-block mt-2 small">
    ุฏุฑ ุงู ุจุฎุด ูโุชูุงูุฏ ูพุณุชโูุง ุฑุง ูุฏุฑุช ฺฉูุฏุ ูุทุงูุจ ุฌุฏุฏ ุจููุณุฏุ ู ูุธุฑุงุช ฺฉุงุฑุจุฑุงู ุฑุง ุจุฑุฑุณ ุง ุญุฐู ููุงุฏ.<br>
    ุงู ูพูู ฺฉุงููุงู ุชูุณุท ุฎูุฏู ุชูุณุนู ุฏุงุฏู ุดุฏู ู ูุงุจู ุงุฑุชูุงุก ู ุดุฎุตโุณุงุฒ ุจุฑ ุงุณุงุณ ูุงุฒูุง ุดูุงุณุช.
  </span>
</div>

<!-- ุขูุงุฑ ุณุฑุน -->
<div class="mb-3 d-flex flex-wrap gap-3">
  <span class="badge bg-success fs-6">ุชุนุฏุงุฏ ฺฉู ูพุณุชโูุง: {{ posts|length }}</span>
  <span class="badge bg-primary fs-6">ุชุนุฏุงุฏ ฺฉู ูุธุฑุงุช: {{ total_comments }}</span>
</div>

<!-- ุฌุฏูู ูพุณุชโูุง -->
<h2 class="mb-4 mt-4">๐ ูุณุช ูพุณุชโูุง</h2>
<table class="table table-bordered table-hover bg-white">
  <thead class="table-dark text-center">
    <tr>
      <th>ุนููุงู</th>
      <th>ุชุงุฑุฎ</th>
      <th>ุนููุงุช</th>
    </tr>
  </thead>
  <tbody>
    {% for post in posts %}
      <tr class="text-center align-middle">
        <td>{{ post.title }}</td>
        <td>{{ post.created_at|date:"Y/m/d" }}</td>
        <td>
          <a href="{% url 'blog:post_detail' post.slug %}" class="btn btn-sm btn-info">
            <i class="bi bi-eye"></i> ูุดุงูุฏู
          </a>
          <a href="{% url 'blog:post_edit' post.slug %}" class="btn btn-sm btn-warning">
            <i class="bi bi-pencil"></i> ูุฑุงุด
          </a>
          <a href="{% url 'blog:post_delete' post.slug %}" class="btn btn-sm btn-danger">
            <i class="bi bi-trash"></i> ุญุฐู
          </a>
        </td>
      </tr>
    {% empty %}
      <tr>
        <td colspan="3" class="text-center text-muted">ูฺ ูพุณุช ูููุฒ ุซุจุช ูุดุฏู ุงุณุช.</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<!-- ูุฏุฑุช ูุธุฑุงุช ฺฉุงุฑุจุฑุงู -->
<hr class="mt-5 mb-4">
<h4 class="text-primary">๐จ๏ธ ูุธุฑุงุช ฺฉุงุฑุจุฑุงู</h4>

{% for post in posts %}
  {% if post.comments.exists %}
    <div class="mb-3">
      <h6 class="mb-2">
        {{ post.title }}
        <span class="badge bg-secondary ms-2">{{ post.comments.count }} ูุธุฑ</span>
      </h6>
      {% for comment in post.comments.all %}
        <div class="bg-light border rounded p-3 mb-2 d-flex justify-content-between align-items-start">
          <div>
            <strong>{{ comment.name }}</strong> 
            <span class="text-muted small">โ {{ comment.created_at|date:"Y/m/d - H:i" }}</span><br>
            <p class="mb-0">{{ comment.content|linebreaks }}</p>
          </div>
          <a href="{% url 'blog:delete_comment' comment.id %}" class="btn btn-sm btn-danger ms-3">
            <i class="bi bi-trash"></i> ุญุฐู
          </a>
        </div>
      {% endfor %}
    </div>
  {% endif %}
{% empty %}
  <p class="text-muted">ูููุฒ ูุธุฑ ุซุจุช ูุดุฏู ุงุณุช.</p>
{% endfor %}

{% endblock %}
