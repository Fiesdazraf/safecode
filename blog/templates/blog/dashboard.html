{% extends "blog/dashboard_base.html" %}
{% block title %}Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ø³Øªâ€ŒÙ‡Ø§{% endblock %}

{% block content %}
<!-- Ú©Ø§Ø±Øª Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯ Ùˆ Ù…Ø¹Ø±ÙÛŒ Ù¾Ù†Ù„ -->
<div class="alert alert-info mb-4 shadow-sm">
  <b>Ø¨Ù‡ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª SafeCode CMS Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯!</b>
  <span class="d-block mt-2 small">
    Ø¯Ø± Ø§ÛŒÙ† Ø¨Ø®Ø´ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù¾Ø³Øªâ€ŒÙ‡Ø§ Ø±Ø§ Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ù†ÛŒØ¯ØŒ Ù…Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÛŒØ¯ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯ØŒ Ùˆ Ù†Ø¸Ø±Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ ÛŒØ§ Ø­Ø°Ù Ù†Ù…Ø§ÛŒÛŒØ¯.<br>
    Ø§ÛŒÙ† Ù¾Ù†Ù„ Ú©Ø§Ù…Ù„Ø§Ù‹ ØªÙˆØ³Ø· Ø®ÙˆØ¯Ù… ØªÙˆØ³Ø¹Ù‡ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ Ùˆ Ù‚Ø§Ø¨Ù„ Ø§Ø±ØªÙ‚Ø§Ø¡ Ùˆ Ø´Ø®ØµÛŒâ€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ù†ÛŒØ§Ø²Ù‡Ø§ÛŒ Ø´Ù…Ø§Ø³Øª.
  </span>
</div>

<!-- Ø¢Ù…Ø§Ø± Ø³Ø±ÛŒØ¹ -->
<div class="mb-3 d-flex flex-wrap gap-3">
  <span class="badge bg-success fs-6">ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù¾Ø³Øªâ€ŒÙ‡Ø§: {{ posts|length }}</span>
  <span class="badge bg-primary fs-6">ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù†Ø¸Ø±Ø§Øª: {{ total_comments }}</span>
</div>

<!-- Ø¬Ø¯ÙˆÙ„ Ù¾Ø³Øªâ€ŒÙ‡Ø§ -->
<h2 class="mb-4 mt-4">ğŸ“‹ Ù„ÛŒØ³Øª Ù¾Ø³Øªâ€ŒÙ‡Ø§</h2>
<div class="table-responsive">
  <table class="table table-bordered table-hover bg-white align-middle text-center">
    <thead class="table-dark">
      <tr>
        <th>Ø¹Ù†ÙˆØ§Ù†</th>
        <th>ØªØ§Ø±ÛŒØ®</th>
        <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
      </tr>
    </thead>
    <tbody>
      {% for post in posts %}
        <tr>
          <td>{{ post.title }}</td>
          <td>{{ post.created_at|date:"Y/m/d" }}</td>
          <td>
            <a href="{% url 'blog:post_detail' post.slug %}" class="btn btn-sm btn-info me-1">
              <i class="bi bi-eye"></i> Ù…Ø´Ø§Ù‡Ø¯Ù‡
            </a>
            <a href="{% url 'blog:post_edit' post.slug %}" class="btn btn-sm btn-warning me-1">
              <i class="bi bi-pencil"></i> ÙˆÛŒØ±Ø§ÛŒØ´
            </a>
            <a href="{% url 'blog:post_delete' post.slug %}" class="btn btn-sm btn-danger">
              <i class="bi bi-trash"></i> Ø­Ø°Ù
            </a>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="3" class="text-center text-muted">Ù‡ÛŒÚ† Ù¾Ø³ØªÛŒ Ù‡Ù†ÙˆØ² Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- Ù…Ø¯ÛŒØ±ÛŒØª Ù†Ø¸Ø±Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† -->
<hr class="mt-5 mb-4">
<h4 class="text-primary mb-4">ğŸ—¨ï¸ Ù†Ø¸Ø±Ø§Øª Ú©Ø§Ø±Ø¨Ø±Ø§Ù†</h4>

{% with total_comment_count=0 %}
  {% for post in posts %}
    {% if post.comments.exists %}
      {% with total_comment_count=total_comment_count|add:post.comments.count %}
        <div class="mb-4">
          <h6 class="mb-2">
            {{ post.title }}
            <span class="badge bg-secondary ms-2">{{ post.comments.count }} Ù†Ø¸Ø±</span>
          </h6>
          {% for comment in post.comments.all %}
            <div class="bg-light border rounded p-3 mb-2 d-flex justify-content-between align-items-start">
              <div>
                <strong>{{ comment.name }}</strong>
                <span class="text-muted small">â€“ {{ comment.created_at|date:"Y/m/d - H:i" }}</span><br>
                <p class="mb-0">{{ comment.content|linebreaks }}</p>
              </div>
              <a href="{% url 'blog:delete_comment' comment.id %}" class="btn btn-sm btn-danger ms-3">
                <i class="bi bi-trash"></i> Ø­Ø°Ù
              </a>
            </div>
          {% endfor %}
        </div>
      {% endwith %}
    {% endif %}
  {% endfor %}

  {% if total_comment_count == 0 %}
    <p class="text-muted text-center mt-4">Ù‡ÛŒÚ† Ù†Ø¸Ø±ÛŒ Ø¨Ø±Ø§ÛŒ Ù‡ÛŒÚ† Ù¾Ø³ØªÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</p>
  {% endif %}
{% endwith %}

{% endblock %}
